<div id="modalAddStockEntry" class="modal-wrapper">
    <div class="modal-overlay"></div>
    <div class="modal-panel">
        <div class="modal-header">
            <h3>Thêm Lô Hàng</h3>
            <button class="modal-close"><i class="bi bi-x-lg"></i></button>
        </div>
        <hr>
        <div class="modal-body">
            <form id="formAddStockEntry">
                <input type="hidden" id="addProductId" name="productId" value="{{product._id}}" />

                <div class="form-group">
                    <label for="batchCode">Mã lô hàng <span class="error">*</span></label>
                    <input type="text" id="addBatchCode" name="batchCode" required />
                </div>

                <div class="form-group">
                    <label for="variantCombinationSelect">Chọn biến thể</label>
                    <select id="addVariantCombinationSelect" name="variantCombinationId">
                        <option value="">-- Không chọn --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="importPrice">Giá nhập (VNĐ) <span class="error">*</span></label>
                    <input type="number" id="addImportPrice" name="importPrice" min="0" required />
                </div>

                <div class="form-group">
                    <label for="quantity">Số lượng nhập <span class="error">*</span></label>
                    <input type="number" id="addQuantity" name="quantity" min="1" required />
                </div>

                <div class="form-group">
                    <label for="note">Ghi chú</label>
                    <textarea id="addNote" name="note" rows="3"
                        placeholder="Ví dụ: Nhập từ xưởng A, hàng loại 1..."></textarea>
                </div>

                <hr>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">Thêm</button>
                    <button type="button" class="btn-secondary modal-close">Huỷ</button>
                </div>
            </form>
        </div>
    </div>
</div>

{{!--

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const searchInput = document.getElementById("searchProduct");
        const resultsContainer = document.getElementById("searchResults");
        const selectedProduct = document.getElementById("selectedProduct");
        const selectedProductImg = document.getElementById("selectedProductImg");
        const selectedProductName = document.getElementById("selectedProductName");
        const selectedProductPrice = document.getElementById("selectedProductPrice");
        const selectedProductId = document.getElementById("selectedProductId");

        let searchTimeout = null;

        // --- Gõ tìm sản phẩm ---
        searchInput.addEventListener("input", async (e) => {
            const query = e.target.value.trim();
            clearTimeout(searchTimeout);
            resultsContainer.innerHTML = "";
            resultsContainer.style.display = "none";

            if (query.length < 2) return; // không tìm nếu quá ngắn

            searchTimeout = setTimeout(async () => {
                try {
                    const res = await fetch(`/api/stock-entries/search-products?q=${encodeURIComponent(query)}`);
                    const result = await res.json();
                    console.log(result);
                    if (!Array.isArray(result.data) || result.data.length === 0) {
                        resultsContainer.innerHTML = `<div class="no-results">Không tìm thấy sản phẩm</div>`;
                        resultsContainer.style.display = "block";
                        return;
                    }

                    resultsContainer.innerHTML = result.data.map(p => `
                    <div class="result-item" data-id="${p.id}" data-name="${p.name}" data-price="${p.price}" data-image="${p.image}">
                        <img src="${p.image}" alt="${p.name}">
                        <div class="result-info">
                            <strong>${p.name}</strong>
                            <span>${p.price.toLocaleString()} ₫</span>
                        </div>
                    </div>
                `).join("");

                    resultsContainer.style.display = "block";
                } catch (err) {
                    console.error("Lỗi tìm kiếm:", err);
                }
            }, 300);
        });

        // --- Chọn sản phẩm ---
        resultsContainer.addEventListener("click", (e) => {
            const item = e.target.closest(".result-item");
            if (!item) return;

            const { id, name, price, image } = item.dataset;

            selectedProductImg.src = image;
            selectedProductName.textContent = name;
            selectedProductPrice.textContent = `${Number(price).toLocaleString()} ₫`;
            selectedProductId.value = id;

            selectedProduct.style.display = "block";
            resultsContainer.style.display = "none";
            searchInput.value = name; // set text vào ô tìm
        });

        // --- Click ngoài để đóng dropdown ---
        document.addEventListener("click", (e) => {
            if (!resultsContainer.contains(e.target) && e.target !== searchInput) {
                resultsContainer.style.display = "none";
            }
        });
    });

</script> --}}